let Post;_cdd‍.x([["write",()=>write],["list",()=>list]]);_cdd‍.w("../../models/post",[["default",["Post"],function(v){Post=v}]]);

/*
  POST /api/posts
  {
    title: '제목',
    body: '내용',
    tags: ['태그1', '태그2']
  }
*/

       const write = async (ctx) => {
  // const schema = Joi.object().keys({
  //   // 객체가 다음 필드를 가지고 있음을 검증
  //   title: Joi.string().required(), // required() 가 있으면 필수 항목
  //   body: Joi.string().required(),
  //   tags: Joi.array()
  //     .items(Joi.string())
  //     .required(), // 문자열로 이루어진 배열
  // });

  // // 검증 후, 검증 실패시 에러처리
  // const result = schema.validate(ctx.request.body);
  // if (result.error) {
  //   ctx.status = 400; // Bad Request
  //   ctx.body = result.error;
  //   return;
  // }

  const { title, body, tags } = ctx.request.body;
  const post = new Post({
    title,
    body,
    tags,
  });
  try {
    await post.save();
    ctx.body = post;
  } catch (e) {
    ctx.throw(500, e);
  }
};

/*
  GET /api/posts
*/
       const list = async (ctx) => {
  try {
    const posts = await Post.find().exec();
    ctx.body = posts;
  } catch (e) {
    ctx.throw(500, e);
  }
};
